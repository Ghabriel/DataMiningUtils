define("types",["require","exports"],function(a,e){"use strict";var t=function(){function a(){}return a}();e.Callable=t;var n=function(){function a(){}return a}();e.Call=n}),define("Interface",["require","exports"],function(a,e){"use strict";var t=function(){function a(a){this.console=a}return a.prototype.newFunction=function(a){var e=document.createElement("div");e.classList.add("fn_def"),e.innerHTML+="<div class='name'>"+a.name+"</div>",e.innerHTML+="<div class='params'>"+a.params.join(",")+"</div>",e.innerHTML+="<div class='body'>"+a.body+"</div>",$(this.console).prepend(e)},a.prototype.newCall=function(a,e){var t=document.createElement("div");t.classList.add("fn_call"),t.innerHTML+="<div class='name'>"+a.name+"</div>",t.innerHTML+="<div class='params'>"+a.params.join(",")+"</div>",t.innerHTML+="<div class='result'>"+e+"</div>",$(this.console).prepend(t)},a}();e.Interface=t}),define("Parser",["require","exports","types"],function(require,exports,types_1){"use strict";var id="[A-Za-z_][A-Za-z0-9_]*",literal="(?:[0-9]*.[0-9]+|[0-9]+.?[0-9]*|"+id+")",paramList="(?: *"+id+"(?: *, *"+id+" *)*)?",argList="(?: *"+literal+"(?: *, *"+literal+" *)*)?",funDefSep="\\s",funDef="("+id+")"+funDefSep+"("+paramList+")"+funDefSep+"(.*)",funCall="("+id+")(?:\\(("+argList+")\\))?",regex={id:new RegExp(id),paramList:new RegExp(paramList),funDef:new RegExp(funDef),funCall:new RegExp(funCall)},Parser=function(){function Parser(a){this.functions=[],this.ui=a}return Parser.prototype.watch=function(a){var e=this;a.addEventListener("keydown",function(a){switch(a.keyCode){case 190:""==this.value&&(this.value=e.lastCommand,a.preventDefault())}}),a.addEventListener("keyup",function(a){switch(a.keyCode){case 13:e.parse(this.value)&&(this.value="")}})},Parser.prototype.parse=function(command){""==command&&(command=this.lastCommand),this.lastCommand=command;var matches=command.match(regex.funDef);if(matches){var action=new types_1.Callable;return action.name=matches[1],action.params=this.split(matches[2],","),action.body=matches[3],this.functions.push(action),this.ui.newFunction(action),this.register(action),!0}if("eval"==command.substr(0,4)){var action=new types_1.Call;action.name="eval",action.params=[];var result=void 0;try{result=eval(command)}catch(a){result="error"}return this.assign("ans",result),this.ui.newCall(action,result),!0}if(matches=command.match(regex.funCall)){var action=new types_1.Call;action.name=matches[1],action.params=this.split(matches[2],",");var output=this.exec(action);return this.ui.newCall(action,output),!0}return!1},Parser.prototype.register=function(a){var e="function(";e+=a.params.join(","),e+=") { return ("+a.body+");}",this.assign(a.name,e)},Parser.prototype.exec=function(call){for(var name in this.builtin)if(this.builtin.hasOwnProperty(name)&&name==call.name){var str=name+"("+call.params.join(",")+")",result=eval(str);return this.assign("ans",result),result}for(var _i=0,_a=this.functions;_i<_a.length;_i++){var fn=_a[_i];if(fn.name==call.name){var expectedNum=fn.params.length,actualNum=call.params.length;if(expectedNum==actualNum){for(var i=0;i<actualNum;i++)this.assign(fn.params[i],eval(call.params[i]));var result=this.eval(fn);return this.assign("ans",result),result}return"wrong number of arguments (expected "+expectedNum+", got "+actualNum+")"}}return"undefined function '"+call.name+"'"},Parser.prototype.assign=function(name,value){"string"==typeof value&&(value="'"+value+"'"),eval("window."+name+"="+value)},Parser.prototype.eval=function(fn){return eval(fn.body)},Parser.prototype.loadNative=function(){function a(){for(var a=[],e=0;e<arguments.length;e++)a[e-0]=arguments[e];for(var t=0,n=0,r=a;n<r.length;n++){var i=r[n];t+=i}return t/a.length}function e(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];for(var n=a.apply(void 0,e),r=0,i=0,s=e;i<s.length;i++){var o=s[i];r+=Math.pow(o-n,2)}return r/(e.length-1)}function t(){for(var a=[],t=0;t<arguments.length;t++)a[t-0]=arguments[t];return Math.sqrt(e.apply(void 0,a))}function n(){for(var a=0,e=r.functions;a<e.length;a++){var t=e[a];console.log(t.name)}return""}this.functions=[{name:"log",params:["x"],body:"Math.log2(x)"},{name:"log2",params:["x"],body:"Math.log2(x)"},{name:"log10",params:["x"],body:"Math.log10(x)"},{name:"ln",params:["x"],body:"Math.log(x)"},{name:"sqrt",params:["x"],body:"Math.sqrt(x)"},{name:"cbrt",params:["x"],body:"Math.cbrt(x)"},{name:"rt",params:["r","x"],body:"Math.pow(x, 1/r)"},{name:"abs",params:["x"],body:"Math.abs(x)"},{name:"exp",params:["x"],body:"Math.exp(x)"},{name:"floor",params:["x"],body:"Math.floor(x)"},{name:"ceil",params:["x"],body:"Math.ceil(x)"},{name:"rand",params:[],body:"Math.random()"},{name:"ans",params:[],body:"ans"},{name:"dist",params:["x1","y1","x2","y2"],body:"(abs(x1-x2) + abs(y1-y2))/2"},{name:"eucldist",params:["x1","y1","x2","y2"],body:"sqrt(pow(x1-x2, 2) + pow(y1-y2, 2))"}];var r=this;this.builtin={avg:a,vari:e,sd:t,help:n};for(var i=0,s=this.functions;i<s.length;i++){var o=s[i];this.register(o)}for(var l in this.builtin)this.builtin.hasOwnProperty(l)&&(window[l]=this.builtin[l])},Parser.prototype.split=function(a,e){return a?a.split(e):[]},Parser}();exports.Parser=Parser}),define("main",["require","exports","Interface","Parser"],function(a,e,t,n){"use strict";$(document).ready(function(){var a=document.querySelector("#command"),e=document.querySelector("#console"),r=document.querySelector("#submit"),i=new n.Parser(new t.Interface(e));r.addEventListener("click",function(){i.parse(a.value)&&(a.value="")}),i.loadNative(),i.watch(a)})});
